<!doctype html>
<html ng-app="calcApp">
  <head>
    <title>Calculadora</title>
    <script src="./bower_components/angular/angular.js"></script>
    <script>
      angular
        .module('calcApp', [])
        .config(function(){})
        .controller('MainCtrl', function($scope, $rootScope, $log){


         })
        .directive('calculadora', function($log, CalcServ){


          return {
            templateUrl: "./calc-directive.html",
            restrict: 'EA',
            scope: {},
            link: function(scope, element, attrs){
              scope.botones = "1234567890-+*/=C".split("");
              scope.resultado = '';

              scope.$watch('resultado', function(oldVal, newVal){
                $log.log("resultado cambio...", scope.resultado);
                //LS.set('res', scope.resultado);
              });


              scope.calcular = function(n){
                $log.log(n);
                if(n === '=') {
                  if (scope.resultado !== '')
                    scope.resultado = CalcServ.evaluar(scope.resultado);
                } else if ( n === 'C') {
                  scope.resultado = '';
                } else {
                  scope.resultado += n;
                }
              }
            }
          }

        })
        .factory('CalcServ', function(){
          return {
            evaluar: function(expr){
              return eval(expr);
            },
            alcuadrado : function(n){
              return n*n;
            }
          };
        })
        .run(function($rootScope){
          $rootScope.mensaje = "ANGULARJS";
        });
    </script>
    <style>
    input.ng-touched {
      border: 1px solid black;
    }
    ul { list-style: none; }
    ul li {
      display: inline-block;
    }
    ul li.left {
      float: left;
    }
    ul li.limpiar {
      background-red: red;
      clear: both;
    }
    </style>
  </head>
  <body>
    <div calculadora>
    Texto por defecto
    </div>
    <calculadora data-moneda="usd"></calculadora>
    <!--
    <div ng-controller="MainCtrl">
    </div>
    -->
  </body>
</html>
